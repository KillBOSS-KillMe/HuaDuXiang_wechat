"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function s(r,a){try{var o=t[r](a),i=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(i).then(function(e){s("next",e)},function(e){s("throw",e)});e(i)}return s("next")})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),_wepy=require("./../npm/wepy/lib/wepy.js"),_wepy2=_interopRequireDefault(_wepy),_ajax=require("./../ajax.js"),api=require("./../api.js"),Index=function(e){function t(){var e,n,s,r;_classCallCheck(this,t);for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=s=_possibleConstructorReturn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),s.config={navigationBarTitleText:"商家入驻"},s.components={},s.mixins=[],s.data={status:20,storeGrade:[],timeArr:[{num:1},{num:2},{num:3}],storeGradeIndex:0,timeIndex:0,useCostPrice:0,bondPrice:0,storeClass:[],storeClassIndex:0,storeClassList:[],store_id:"",joinInfo:{},entryIndex:[0,0,0],entryName:"",entryId:null,entryArr:[],type:1},s.computed={useCostPrice:function(){var e=this.timeArr[this.timeIndex].num,t=this.storeGrade[this.storeGradeIndex]&&this.storeGrade[this.storeGradeIndex].sg_price;return(Number(e)*Number(t)).toFixed(2)},bondPrice:function(){var e=this.storeClass[this.storeClassIndex]&&this.storeClass[this.storeClassIndex].sc_bail;return Number(e).toFixed(2)}},s.watch={},s.methods={submit:function(e){var t=e.detail.value,n=t.admin,s=t.password,r=t.name,a=t.code,o=t.contacts,i=t.phone,u=t.address,c=t.remarks;return/^(\w){6,20}$/.test(n)?/^(\w){6,20}$/.test(s)?r?/^(\w){6,20}$/.test(a)?o?11!=i.length?(wx.showToast({title:"请输入正确的联系电话",icon:"none"}),!1):u?this.entryName?c?void(0,_ajax.ajax)({url:api.addStore,data:{store_name:r,store_code:a,contacts_name:o,contacts_phone:i,company_address_detail:u,remark:c,joinin_year:this.timeArr[this.timeIndex].num,sc_id:this.storeClass[this.storeClassIndex].sc_id,sc_name:this.storeClass[this.storeClassIndex].sc_name,sc_bail:this.storeClass[this.storeClassIndex].sc_bail,sg_id:this.storeGrade[this.storeGradeIndex].sg_id,sg_name:this.storeGrade[this.storeGradeIndex].sg_name,sg_info:this.storeGrade[this.storeGradeIndex].sg_price,seller_name:n,seller_psw:s,store_class_ids:this.entryId,store_class_names:this.entryName,type:this.type}}).then(function(e){wx.showToast({title:e.datas.msg,icon:"none"})}):(wx.showToast({title:"请输入备注",icon:"none"}),!1):(wx.showToast({title:"请输入店铺条目",icon:"none"}),!1):(wx.showToast({title:"请输入商铺地址",icon:"none"}),!1):(wx.showToast({title:"请输入联系人姓名",icon:"none"}),!1):(wx.showToast({title:"请输入6至20位商铺编号",icon:"none"}),!1):(wx.showToast({title:"请输入商铺名称",icon:"none"}),!1):(wx.showToast({title:"请输入6至20位密码",icon:"none"}),!1):(wx.showToast({title:"请输入6至20位商铺账号",icon:"none"}),!1)},storeGradeChange:function(e){var t=e.detail.value;this.storeGradeIndex=t},timeChange:function(e){this.timeIndex=e.detail.value},storeClassChange:function(e){this.storeClassIndex=e.detail.value},bindMultiPickerChange:function(e){var t=e.detail.value;this.entryIndex=t;var n=this.entryArr;this.entryName=n[0][t[0]].gc_name+","+n[1][t[1]].gc_name+","+n[2][t[2]].gc_name,this.entryId=n[0][t[0]].gc_id+","+n[1][t[1]].gc_id+","+n[2][t[2]].gc_id},bindMultiPickerColumnChange:function(e){this.setList(e.detail.column,e.detail.value)},againInfo:function(e){this.status=-10},settledIn:function(){}},s.events={},r=n,_possibleConstructorReturn(s,r)}return _inherits(t,e),_createClass(t,[{key:"onShow",value:function(){}},{key:"setList",value:function(e,t){var n=this.entryArr[0];if(0==e)this.entryArr[1]=n[t].two,this.entryArr[2]=n[t].two[0].three;else if(1==e)this.entryArr[2]=this.entryArr[1][t].three;else if(3==e)return!1}},{key:"onLoad",value:function(){function e(){return t.apply(this,arguments)}var t=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.next=3,(0,_ajax.ajax)({url:api.isJoin,type:"get"}).then(function(e){if(n.status=e.datas.state,-10!=e.datas.state){n.type=2,n.joinInfo=e.datas.data;var t=n.joinInfo.joinin_year;n.entryId=n.joinInfo.store_class_ids,n.entryName=n.joinInfo.store_class_names,n.timeArr.forEach(function(e,s){e.num==t&&(n.timeIndex=s)})}n.store_id=e.datas.store_id,n.$apply()});case 3:(0,_ajax.ajax)({url:api.getStoreGrade}).then(function(e){n.storeGrade=e.datas.data;var t=n.joinInfo.sg_id;e.datas.data.forEach(function(e,s){e.sg_id==t&&(n.storeGradeIndex=s)}),n.$apply()}),(0,_ajax.ajax)({url:api.getStoreClass}).then(function(e){n.storeClass=e.datas.data||[];var t=n.joinInfo.sc_id;e.datas.data.forEach(function(e,s){e.sc_id==t&&(n.storeClassIndex=s)}),n.$apply()}),(0,_ajax.ajax)({url:api.oneGoodsClass}).then(function(e){var t=e.datas,s=t[0].two,r=s[0].three,a=[];a.push(t),a.push(s),a.push(r),n.entryArr=a,n.$apply()});case 6:case"end":return e.stop()}},e,this)}));return e}()}]),t}(_wepy2.default.page);Page(require("./../npm/wepy/lib/wepy.js").default.$createPage(Index,"pages/settledIn"));